# Compact version of the test_find_index protocol

import "../../../src/proto/library/BasicLibrary.txt"

post-processing {
    # Create 3x5 input array
    input = [ i*5 + j for i in 0:3 for j in 0:5 ]
    input_max = 14
    
    # All but one entry
    all_bar_largest = map(lambda x: x < input_max, input)
    all_bar_largest_idxs = find(all_bar_largest)
    all_bar_largest_indexed = input{all_bar_largest_idxs, 0, pad:1=-1}
    
    # Whole array
    all_entries = map(lambda x: x < input_max + 1, input)
    all_entries_idxs = find(all_entries)
    all_entries_indexed = input{all_entries_idxs}
    assert ArrayEq(all_entries_indexed, input)
}
